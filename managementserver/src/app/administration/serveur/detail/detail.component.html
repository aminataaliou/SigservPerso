<div class="container-xl">
  <div class="">
    <div class="table-wrapper">
      <div class="table-title my-4">
        <div class="row ">
          <div tuiSlot="left" class="d-flex align-items-center">
            <button
              tuiIconButton
              appearance="secondary-destructive"
              size="s"
              icon="tuiIconArrowLeftCircleLarge"
              title="Retour"
              shape="rounded"
              type="button"
              routerLink="/admin/serveurs/liste"
            ></button>
            <h3 class="mb-0 mx-2" ><b>Detail du Serveur</b></h3>
          </div>
        </div>
      </div>


      <tui-tabs
        tuiMobileTabs
        [(activeItemIndex)]="activeItemIndex"
      >
        <button
          class="mb-1 "
          *ngFor="let item of items,let i = index"
          tuiTab
          [ngClass]="{'text-danger': activeItemIndex===i}"
        >
          <tui-svg
            class="tui-space_right-2"
            [src]="item.icon"
          ></tui-svg>
          {{ item.text }}
        </button>
      </tui-tabs>

      <table *ngIf="activeItemIndex===0" class="table table-striped table-hover table-bordered mt-4 table-conten">
      <tbody>
      <tr>
        <td><label ><b>ID</b></label></td>
        <td><span >{{ serveur?.id }}</span></td>
      </tr>
      <tr>
        <td><label  ><b>Nom</b></label> </td>
        <td><span  >{{ serveur?.nom }}</span></td>
      </tr>
      <tr>
        <td> <label ><b>Adresse IP</b></label></td>
        <td> <span >{{ serveur?.adresseip}}</span></td>
      </tr>
      <tr>
        <td> <label ><b>Type</b></label></td>
        <td><span  >{{ serveur?.type}}</span></td>
      </tr>
      <tr>
        <td> <label ><b>Etat</b></label></td>
        <td> <span >{{ serveur?.etat}}</span></td>
      </tr>

      <tr>
        <td> <label ><b>Systeme</b></label></td>
        <td> <span >{{ serveur?.systeme?.nom}}</span></td>
      </tr>
      <tr>
        <td> <label ><b>Tags</b></label></td>
        <td> <span >{{ serveur?.tags}}</span></td>
      </tr>
      <tr>
        <td> <label ><b>Date Creation</b></label></td>
        <td> <span >{{ serveur?.createdAt | date :'short'}}</span></td>
      </tr>
      <tr>
        <td> <label ><b>Date Mise à jour </b></label></td>
        <td> <span  >{{ serveur?.updatedAt | date :'short'}}</span></td>
      </tr>
      </tbody>
      </table>

      <div>
        <div
          tuiTextfieldSize="m"
          class="filters my-4 me-4 d-flex justify-content-between"
        >
          <form
            [formGroup]="serveurVirtuelForm"  (ngSubmit)="servVirtuelSubmit" >
          <div >
            <button
              tuiButton
              size="m"
              style="min-width: 250px !important"
              type="button"
              icon="tuiIconPlus"
              class="shadow  "
              appearance="accent"
              *ngIf="activeItemIndex===1"
              (click)="showDialogVirtuel()"
            >
              Ajouter le serveur virtuel
            </button>
            <ng-template
              let-observer
              [tuiDialogOptions]="{label: ' Ajout Serveur Virtuel', size: 'm'}"
              [(tuiDialog)]="open1"
            >

                <tui-multi-select
                  tuiTextfieldSize="m"
                  [editable]="false"
                  formControlName="serveurs"
                  [tuiTextfieldCleaner]="true"
                  [tuiTextfieldLabelOutside]="true"
                  [stringify]="stringifyServeurVirtuel"
                  [valueContent]="contentServeurVirtuel"
                >
                  Serveur Virtuel
                  <tui-data-list-wrapper
                    *tuiDataList
                    tuiMultiSelectGroup
                    [items]="serveurs"
                    [itemContent]="contentServeurVirtuel"
                    [emptyContent]="'Aucun serveur'"
                  ></tui-data-list-wrapper>
                </tui-multi-select>
                <ng-template #contentServeurVirtuel let-serveurVirtuel>
                  <div class="template">
                    <div class="serveurvirtuel"> Nom: {{serveur?.nom}} | Adresse Ip: {{serveur?.adresseip}} | Etat: {{serveur?.etat}} | Systeme: {{serveur?.systeme}} | CreatedAt: {{serveur?.createdAt}}</div>
                  </div>
                </ng-template>
                <p>
                  <button
                    tuiButton
                    type="submit"
                    appearance="accent"
                    class="my-4"
                    (click)="servVirtuelSubmit()"
                  >
                    Ajouter
                  </button>
                </p>

            </ng-template>
          </div>
          </form>
        </div>
      <table
        tuiTable
        class="container-fluid mt-4"
        [columns]="columnsServeur"
        *ngIf="activeItemIndex===1"
      >
        <thead>
        <tr tuiThGroup>
          <th
            *tuiHead="'nom'"
            tuiTh
          >
            Nom du serveur
          </th>
          <th
            *tuiHead="'etat'"
            tuiTh
          >
            Etat
          </th>
          <th
            *tuiHead="'adresseip'"
            tuiTh
          >
            Adresse IP
          </th>
          <th
            *tuiHead="'systeme'"
            tuiTh
          >
            Systeme
          </th>

          <th
            *tuiHead="'createdAt'"
            tuiTh
          >
            Date de Création
          </th>
        </tr>
        </thead>
        <tbody
          *tuiLet="serveurVirtuelByServeurId | tuiTableSort as sortedServeurVirtuel"
          tuiTbody
          [data]="sortedServeurVirtuel"
        >
        <tr
          *ngFor="let serveur of sortedServeurVirtuel; let index = index"
          tuiTr
        >
          <td
            *tuiCell="'nom'"
            tuiTd
          >
            {{ index + 1 }}. {{ serveur.nom }}
          </td>
          <td
            *tuiCell="'etat'"
            tuiTd
          >
            <div [class]="serveur.etat">{{ serveur.etat }}</div>
          </td>
          <td
            *tuiCell="'adresseip'"
            tuiTd
          >
            <div [class]="serveur.adresseIp">{{ serveur.adresseip }}</div>
          </td>
          <td
            *tuiCell="'systeme'"
            tuiTd
          >
            <div>{{ serveur?.systeme?.nom }}</div>
          </td>
          <td
            *tuiCell="'tags'"
            tuiTd
          >

          <td
            *tuiCell="'createdAt'"
            tuiTd
          >
            <div [class]="serveur.createdAt">{{ serveur.createdAt | date :'short' }}</div>
          </td>
        </tbody>
      </table>
            </div>
    <table *ngIf="activeItemIndex===2" class="table table-striped table-hover table-bordered mt-4 table-conten">
        <tbody>
        <tr>
          <td> <label><b>Data Center</b></label></td>
          <td><span>{{ serveur?.emplacement?.datacenter}}</span></td>
        </tr>
        <tr>
          <td><label><b>Armoire</b></label></td>
          <td><span>{{ serveur?.emplacement?.armoire }}</span></td>
        </tr>
        <tr>
          <td><label><b>Etagère</b></label> </td>
          <td><span>{{ serveur?.emplacement?.etagere }}</span></td>
        </tr>
        <tr>
          <td> <label><b>couloir</b></label></td>
          <td> <span>{{ serveur?.emplacement?.couloir}}</span></td>
        </tr>
       <tr>
          <td> <label><b>Date Creation</b></label></td>
          <td> <span>{{ serveur?.emplacement?.createdAt | date :'short'}}</span></td>
        </tr>
        <tr>
          <td> <label><b>Date Mise à jour </b></label></td>
          <td> <span>{{ serveur?.emplacement?.updatedAt | date :'short'}}</span></td>
        </tr>
        </tbody>
      </table>
    <div>
      <div
        tuiTextfieldSize="m"
        class="filters my-4 me-4 d-flex justify-content-between"
      >
        <form [formGroup]="servAppliForm" class="col-md-8 " (ngSubmit)="servAppliSubmited()">
        <div >
          <button
            tuiButton
            size="m"
            style="min-width: 250px !important"
            type="button"
            icon="tuiIconPlus"
            class="shadow  "
            appearance="accent"
            *ngIf="activeItemIndex===3"
            (click)="showDialogAppli()"
          >
            Ajouter l'application
          </button>
          <ng-template
            let-observer
            [tuiDialogOptions]="{label: ' Ajout Application', size: 'm'}"
            [(tuiDialog)]="open"
          >
            <tui-multi-select
              class="input"
              tuiTextfieldSize="m"
              [tuiTextfieldCleaner]="true"
              [tuiTextfieldLabelOutside]="true"
              [stringify]="stringifyApplication"
              [valueContent]="contentApplication"
              formControlName="applications"
            >
              APPLICATION
              <tui-data-list-wrapper
                *tuiDataList
                [items]="applications"
                [itemContent]="contentApplication"
              ></tui-data-list-wrapper>
            </tui-multi-select>
            <ng-template #contentApplication let-application>
              <div class="template">
                <div class="application"> NOM: {{application?.nom}} | ADRESSE IP: {{application?.adresseIp}} | PORT: {{application?.port}} | URL: {{application?.url}} | TYPE: {{application?.type}}| DATE DE CREATION: {{application?.CreatedAt}}</div>
              </div>
            </ng-template>
              <p>
                <button
                  (click)="servAppliSubmited()"
                  tuiButton
                  type="submit"
                  appearance="accent"
                  class="my-4"
                >
                  Ajouter
                </button>
              </p>
          </ng-template>
        </div>
        </form>
      </div>
      <table
        tuiTable
        class="container-fluid mt-4"
        *ngIf="activeItemIndex===3"
        [columns]="columns"
      >
        <thead>
        <tr tuiThGroup>
          <th
            *tuiHead="'nom'"
            tuiTh
          >
            Nom de l'application
          </th>
          <th
            *tuiHead="'type'"
            tuiTh
          >
            Type
          </th>
          <th
            *tuiHead="'etat'"
            tuiTh
          >
            Etat
          </th>
          <th
            *tuiHead="'adresseIp'"
            tuiTh
          >
            Adresse IP
          </th>
          <th
            *tuiHead="'port'"
            tuiTh
          >
            Port
          </th>
          <th
            *tuiHead="'url'"
            tuiTh
          >
            URL
          </th>
          <th
            *tuiHead="'createdAt'"
            tuiTh
          >
            Date de Création
          </th>

          <th
            *tuiHead="'tags'"
            tuiTh
            [sorter]="null"
          >
            Tags
          </th>
          <th
            *tuiHead="'actions'"
            tuiTh
            [sorter]="null"
          ></th>
        </tr>
        </thead>
        <tbody
          *tuiLet="applicationsByServeurId | tuiTableSort as sortedApplication"
          tuiTbody
          [data]="sortedApplication"
        >
        <tr
          *ngFor="let application of sortedApplication; let index = index"
          tuiTr
        >
          <td
            *tuiCell="'nom'"
            tuiTd
          >
            {{ index + 1 }}. {{ application.nom }}
          </td>
          <td
            *tuiCell="'type'"
            tuiTd
          >
            <a
              *ngIf="application.type"
              tuiLink
              [href]="'mailto:' + application.type"
            >
              {{ application.type }}
            </a>
          </td>
          <td
            *tuiCell="'etat'"
            tuiTd
          >
            <div [class]="application.etat">{{ application.etat }}</div>
          </td>
          <td
            *tuiCell="'adresseIp'"
            tuiTd
          >
            <div [class]="application.adresseIp">{{ application.adresseIp }}</div>
          </td>
          <td
            *tuiCell="'port'"
            tuiTd
          >
            <div [class]="application.port">{{ application.port }}</div>
          </td>
          <td
            *tuiCell="'url'"
            tuiTd
          >
            <div [class]="application.url">{{ application.url }}</div>
          </td>

          <td
            *tuiCell="'createdAt'"
            tuiTd
          >
            <div [class]="application.createdAt">{{ application.createdAt | date :'short' }}</div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
    <div>
      <div
        tuiTextfieldSize="m"
        class="filters my-4 me-4 d-flex justify-content-between"
      >
        <form class="col-md-8 ">
          <div>
            <button
              tuiButton
              size="m"
              style="min-width: 250px !important"
              type="button"
              icon="tuiIconPlus"
              class="shadow  "
              appearance="accent"
              *ngIf="activeItemIndex===4"
              (click)="showDialogCompte()"
            >
              Ajouter Compte
            </button>
            <ng-template
              let-observer
              [tuiDialogOptions]="{label: ' Ajout Compte', size: 'm'}"
              [(tuiDialog)]="open2"
            >
              <tui-multi-select
                class="input"
                [tuiTextfieldCleaner]="true"
                [tuiTextfieldLabelOutside]="true"
                [(ngModel)]="value2"
              >
                COMPTE D'ACCES
                <tui-data-list-wrapper
                  *tuiDataList
                  [items]="comptedacces"
                  [emptyContent]="'Aucun Compte'"
                ></tui-data-list-wrapper>
              </tui-multi-select>

              <p>
                <button
                  tuiButton
                  type="submit"
                  appearance="accent"
                  class="my-4"
                >
                  Ajouter
                </button>
              </p>
            </ng-template>
          </div>
        </form>
      </div>

              <table
        tuiTable
        class="container-fluid mt-4"
        *ngIf="activeItemIndex===4"
        [columns]="columnsCompte"
      >
        <thead>
        <tr tuiThGroup>
          <th
            *tuiHead="'nom'"
            tuiTh
          >
            Nom d'utilisateur
          </th>
          <th
            *tuiHead="'password'"
            tuiTh
          >
            Mot De Passe
          </th>
          <th
            *tuiHead="'createdAt'"
            tuiTh
          >
            Date de Création
          </th>
        </tr>
        </thead>
        <tbody
          *tuiLet="compteByServeurId | tuiTableSort as sortedComptedacces"
          tuiTbody
          [data]="sortedComptedacces"
        >
        <tr
          *ngFor="let comptedacces of sortedComptedacces; let index = index"
          tuiTr
        >
          <td
            *tuiCell="'nom'"
            tuiTd
          >
            {{ index + 1 }}. {{ comptedacces.nom }}
          </td>
          <td
            *tuiCell="'password'"
            tuiTd
          >
            <div [class]="comptedacces.password">{{ comptedacces.password }}</div>
          </td>
          <td
            *tuiCell="'createdAt'"
            tuiTd
          >
            <div [class]="comptedacces.createdAt">{{ comptedacces.createdAt | date :'short' }}</div>
          </td>
        </tbody>
      </table>
      </div>
    </div>
  </div>
</div>
